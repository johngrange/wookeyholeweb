(function(){function t(n){var t=n.getSelection();return(element=t&&t.getSelectedElement()||null,element&&element.is("img")&&!element.data("cke-realelement")&&!element.isReadOnly())?element:!1}var i={href:"index.php?option=com_media&view=images&tmpl=component&e_name={EDITOR}&asset=com_content&arkimage=1&author=",exec:function(n){var i,e,r,u,f;this.href=this.href.replace("{EDITOR}",n.name);i=this;e=function(n){n.cancel()};n.editable().once("blur",e,null,null,-100);SqueezeBox.open(null,{handler:"iframe",size:{x:800,y:500},url:this.href});r=t(n);r&&(u=function(){var t=n.getSelection();CKEDITOR.env.ie&&t&&(n._bookmarks=t.createBookmarks2());CKEDITOR.tools.setTimeout(function(){SqueezeBox.removeEvent("onOpen",u)},0,i)},f=function(){var t=CKEDITOR.document.getById("sbox-window").findOne("#sbox-content iframe");t.on("load",function(){var u=t.getFrameDocument(),e=u.getWindow().$.ImageManager;e.populateElementValues||(e.populateElementValues=function(n){var t;this.fields.url.value=n.data("cke-saved-src")||n.getAttribute("src");this.fields.alt.value=n.getAttribute("alt");this.fields.title.value=n.getAttribute("title");n.hasClass("pull-left")?(this.fields.align.value="left",t=this.fields.align.options[this.fields.align.selectedIndex].text,u.findOne("#f_align_chzn a.chzn-single span").setText(t)):n.hasClass("pull-center")?(this.fields.align.value="center",t=this.fields.align.options[this.fields.align.selectedIndex].text,u.findOne("#f_align_chzn a.chzn-single span").setText(t)):n.hasClass("pull-right")?(this.fields.align.value="right",t=this.fields.align.options[this.fields.align.selectedIndex].text,u.findOne("#f_align_chzn a.chzn-single span").setText(t)):(this.fields.align.value="",t=this.fields.align.options[this.fields.align.selectedIndex].text,u.findOne("#f_align_chzn a.chzn-single span").setText(t))});e.populateElementValues(r,n);CKEDITOR.tools.setTimeout(function(){SqueezeBox.removeEvent("onOpen",f)},0,i)})},CKEDITOR.env.ie&&SqueezeBox.addEvent("onOpen",u),SqueezeBox.addEvent("onOpen",f))}},n="arkimage";CKEDITOR.plugins.add("imagemanager",{requires:"image",icons:"image",hidpi:!0,init:function(t){var r=t.addCommand(n,i);r.modes={wysiwyg:1};t.ui.addButton&&t.ui.addButton("Image",{label:t.lang.common.image,command:n});t.on("doubleclick",function(i){var r=i.data.element;if(r.is("img")&&!r.data("cke-realelement")&&!r.isReadOnly())return t.execCommand(n),!1},null,null,5);t.removeMenuItem&&t.removeMenuItem("image");t.addMenuItems&&t.addMenuItems({image:{label:t.lang.image.menu,command:n,group:"image"}})}})})()