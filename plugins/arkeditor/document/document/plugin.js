(function(){var t={href:"index.php?option=com_media&view=images&tmpl=component&e_name={EDITOR}&asset=com_content&arkmedia=1&author=",exec:function(n){var r=CKEDITOR.plugins.link,t=null,u,o,i,f,e;this.href=this.href.replace("{EDITOR}",n.name);u=this;o=function(n){n.cancel()};n.editable().once("blur",o,null,null,-100);SqueezeBox.open(null,{handler:"iframe",size:{x:800,y:500},url:this.href});i=n.getSelection();(t=r.getSelectedLink(n)&&r.getSelectedLink(n).hasAttribute("href")&&r.getSelectedLink(n)||i&&(i.getSelectedElement()&&i.getSelectedElement().getOuterHtml()||i.getSelectedText()))&&(f=function(){var t=n.getSelection();CKEDITOR.env.ie&&t&&(n._bookmarks=t.createBookmarks2());CKEDITOR.tools.setTimeout(function(){SqueezeBox.removeEvent("onOpen",f)},0,u)},e=function(){var i=CKEDITOR.document.getById("sbox-window").findOne("#sbox-content iframe");i.on("load",function(){var f=i.getFrameDocument(),r=f.getWindow().$.MediaManager;r.populateElementValues||(r.populateElementValues=function(n){this.html=n.getHtml();this.fields.url.value=n.data("cke-saved-href")||n.getAttribute("href");this.fields.rel.value=n.getAttribute("rel");this.fields.title.value=n.getAttribute("title");this.fields.text.value=n.getText();target=n.getAttribute("target")||"";this.fields.target.value=target;var t=this.fields.target.options[this.fields.target.selectedIndex].text;f.findOne("#f_target_chzn a.chzn-single span").setText(t)});typeof t=="string"&&(t=CKEDITOR.dom.element.createFromHtml('<a href="" rel="" title="">'+t+"<\/a>"));r.populateElementValues(t,n);CKEDITOR.tools.setTimeout(function(){SqueezeBox.removeEvent("onOpen",e)},0,u)})},CKEDITOR.env.ie&&SqueezeBox.addEvent("onOpen",f),SqueezeBox.addEvent("onOpen",e))}},n="arklink";CKEDITOR.plugins.add("document",{lang:"en,de,es,fi,fr,he,it,nl,ru,zh-cn",icons:"document",hidpi:!1,init:function(i){var u=i.addCommand(n,t),r;u.modes={wysiwyg:1};r=/(?:[^\/])\/(([^\u0000-\u007F]|[\w-])+\.(?!(?:htm|php|asp|jsp|cfm|pl|cgi))\w+)$/;i.on("doubleclick",function(t){var u=CKEDITOR.plugins.link.getSelectedLink(i)||t.data.element;if(!u.isReadOnly())if(u.is("a")){if(u.getAttribute("name")||!u.getAttribute("href")&&u.getChildCount())u.getAttribute("name")&&(!u.getAttribute("href")||u.getChildCount())&&(t.data.dialog="anchor");else if(r.test(u.getAttribute("href")))return setTimeout(function(){i.execCommand(n)},0),!1}else CKEDITOR.plugins.link.tryRestoreFakeAnchor(i,u)&&(t.data.dialog="anchor")},null,null,5);i.addMenuItems&&i.addMenuItems({document:{label:i.lang.document.menu,command:n,group:"link",order:1}});i.ui.addButton&&i.ui.addButton("Document",{label:i.lang.document.toolbar,command:n});i.contextMenu&&i.contextMenu.addListener(function(n){var t,u;return!n||n.isReadOnly()?null:(t=CKEDITOR.plugins.link.tryRestoreFakeAnchor(i,n),!t&&!(t=CKEDITOR.plugins.link.getSelectedLink(i)))?null:(u={},t.getAttribute("href")&&t.getChildCount()&&r.test(t.getAttribute("href"))&&(u={document:CKEDITOR.TRISTATE_OFF}),u)})}})})()